# TDD(Test Driven Development)란 무엇이며 어떠한 장점이 있는가?

## 단위 테스트

- 한 단위(일반적으로 class)만을 테스트 하는 것

### 목적

- 코드를 수정하거나 기능을 추가할 때 수시로 빠르게 검증
- 리팩토링시에 안정성 확보
- 개발 및 테스팅에 대한 시간과 비용 절감
    - 통합 테스를 위해서는 캐시, 데이터베이스 등 외부 컴포넌트들과 연결 등 부가적인 시간이 필요하여 비용이 큼
    - 테스트 코들르 작성하지 않았다면 여러개의 버그가 잠재되어 있을 확률이 있고, 모든 버그들을 수정하고 테스트 하는 비용은 기하급수적으로 늘어나게 된다

### 좋은 테스트의 특징

- **FIRST**라는 5가지의 규칙을 따라야 한다
    1. **Fast**: 테스트틑 빠르게 동작하여 자주 돌릴 수 있어야 한다
    2. **Independent**: 각각의 테스트는 독립적이며 서로 의존해서는 안된다
    3. **Repeatable**: 어느 환경에서도 반복 가능해야 한다
    4. **Self-Validating**: 테스트는 성공 또는 실패로 bool 값으로 결과를 내어 자체적으로 검증되어야 한다
    5. **Timely**: 테스트는 적시에 즉, 테스트하려는 실제 코드를 구현하기 직전에 구현해야 한다
        - 테스트 코드를 먼저 작성하는 개발 방법론은 **TDD**로 많이 불림
        - 테스트 코드를 먼저 작성해야 하는 이유
            - 깔끔한 코드를 작성할 수 있다
            - 장기적으로 개발 비용을 절감할 수 있다
            - 개발이 끝나면 테스트 코드를 작성하는 것은 매우 귀찮음
- 즉 좋은 테스트는 빠르게 독립적으로 어느 환경에서든 실행이 가능하고 검증할 수 있어야 하는 것

## TDD

- Test Driven Development
- 테스트 주도 개발
- 반복 테스트를 이용한 소프트웨어 방법론으로 작은 단위의 테스트 케이스를 작성하고, 이를 통과하는 코드를 추가하는 단계를 반복하여 구현
- 짧은 개발 주기의 반복에 의존하는 개발 프로세스
- 애자일 방법론 중 하나인  extream programming(xp)의 `Test-First` 개념에 기반을 둔 단순한 설계를 중요시 함

### 개발 주기

<img src="https://i0.wp.com/hanamon.kr/wp-content/uploads/2021/04/TDD-%E1%84%80%E1%85%A2%E1%84%87%E1%85%A1%E1%86%AF%E1%84%8C%E1%85%AE%E1%84%80%E1%85%B5.png?w=1024&ssl=1" width="50%">

- `Write a falling test`: 실패하는 테스트 코드를 먼저 작성
- `Make the test pass`: 테스트 코드를 성공시키기 위한 실제 코드 작성
    - 빨리 테스트를 통과하기 위해 프로덕션 코드를 작성
        - 이를 위해 정답이 아닌 가짜 구현 등을 작성할 수 있다
    - 그 다음의 테스트 코드를 작성한다
        - 실패 테스트가 없을 경우에만 성공 테스트 작성
    - 새로운 테스트를 통과하기 위해 프로덕션 코드를 추가 또는 수정
- 위의 두 단계를 반복하여 실패, 성공의 모든 테스트 케이스 작성
- `Refactor`: 중복 코드 제거, 일반화 등의 리팩토링 수행


> 💡 중요한 것은 실패하는 **테스트 코드를 작성할 때까지 실제 코드를 작성하지 않는 것**과, **실패하는 테스트를 통과할 정도의 최소 실제 코드를 작성**해야 하는 것


- 실제 코드에 대해 기대되는 바를 보다 명확하게 정의함으로써 불필요한 설계를 피할 수 있고, 정확한 요구사항에 집중할 수 있다

### 일반적인 개발 방식

![일반적인 개발 방식](https://user-images.githubusercontent.com/63137536/212486628-181c8969-34b8-42d6-b8ef-d767d5fe3712.png)
- 요구사항 분석 → 설계 → 개발 → 테스트 → 배포
- 잠재적 위험 존재
    - 소비자의 요구사항이 처음부터 명확하지 않을 수 있다
    - 따라서 처음부터 완벽한 설계는 어려움
    - 자체 버그 검출 능력 저하 또는 소스 코드의 품질 저하
    - 자체 테스트 비용 증가
- 작은 부분의 기능 수정에도 모든 부분을 테스트해야 하므로 전체적인 버그를 검출하기 어려워짐

> 결론적으로 이러한 코드들은 재사용이 어렵고 관리가 어려워져 유지 보수를 어렵게 만든다
> 

### TDD의 개발 방식

- 일반적인 개발 방식과의 가장 큰 차이점은 테스트 코드를 작성한 뒤에 실제 코드를 작성한다는 것
- 디자인(설계) 단계에서 프로그래밍 목적을 반드시 미리 정의해야한다
- 테스트 코드를 작성하는 도중 발생하는 예외사항(버그 및 수정사항)은 테스트 케이스에 추가하고 설계를 개선
- 이후 테스트 코드가 통과된 코드만을 코드 개발단계에서 실제 코드로 작성
    
    ![TDD프로세스](https://user-images.githubusercontent.com/63137536/212486691-0e784e2b-3f5e-4c32-9a2d-19de0de6cc9f.png)
    

> 이러한 반복적인 단계가 진행되면서 자연스럽게 코드의 버그가 줄어들고 소스코드는 간결해진다.
> 

## 장점

### 보다 튼튼한 객체 지향적인 코드 생산

- TDD는 코드의 재사용을 보장을 명시하므로 TDD를 통한 소프트웨어 개발시 기능별 철저한 모듈화가 이루어진다
- 이는 종속성과 의존성이 낮은 모듈로 조합된 소프트웨어 개발을 가능하게 하며 필요에 따라 모듈을 추가하거나 제거해도 소프트웨어 전체 구조에 영향을 미치지 않게 된다

### 재설계 시간의 단축

- 테스트 코드를 먼저 작성하기 때문에 개발자가 지금 무엇을 해야하는지 분명히 정의하고 개발을 시작하게 된다
- 테스트 시나리오를 작성하며 다양한 예외사항에 대해 생각해 볼 수 있다
    - 개발 진행 중 소프트웨어의 전반적인 설계가 변경되는 일 방지

### 디버깅 시간의 단축

- 통합 테스트를 통해 발견한 버그의 경우 어느 곳에서 발생한 것인지 몰라 전부 디버깅 해야한다
- TDD는 자동회된 유닛 테스팅을 전제하므로 특정 버그를 손 쉽게 찾아낼 수 있다

### 테스트 문서의 대체 가능

- 테스팅을 자동화 시킴과 동시에 보다 정확한 테스트 근거 산출 가능

### 추가 구현의 용이함

- 어떤 기능을 추가할 때 해당 기능이 기존 코드에 어떤 영향을 미칠지 알지 못함
- 하지만 TDD는 자동화된 유닛 테스팅을 전제하므로 테스트 기간 획기적으로 단축

## 단점

### 생산성 저하

- 개발속도가 느려진다고 생각하는 사람이 많아 TDD에 반신반의함
- 처음부터 2개의 코드를 짜야하고, 중간중간 테스트를 하며 고쳐 나가야하기 때문
- 일반적인 개발 방식에 비해 10~30%정도 늘어남


참고

[TDD란? 테스트 주도 개발 - 하나몬](https://hanamon.kr/tdd%EB%9E%80-%ED%85%8C%EC%8A%A4%ED%8A%B8-%EC%A3%BC%EB%8F%84-%EA%B0%9C%EB%B0%9C/)

[[TDD] 단위 테스트와 TDD(테스트 주도 개발) 프로그래밍 방법 소개 - (1/5)](https://mangkyu.tistory.com/182)
