# 교착 상태(Dead Lock)

> 상호 배제에 의해 나타나는 문제점으로, 둘 이상의 프로세스들이 자원을 점유한 상태에서 서로 다른 프로세스가 점유하고 있는 자원을 요구하며 무한정 기다리는 현상
> 

## 발생 조건

### 상호 배제

- 한번에 프로세스 하나만 해당 자원 사용할 수 있어야 한다
- 사용중인 자원을 다른 프로세스가 사용하려면 요청한 자원이 해제될 때 까지 기다려야 한다

### 점유 대기

- 자원을 최소한 하나 보유하고, 다른 프로세스에 할당된 자원을 점유하기 위해 대기하는 프로세스가 존재해야 한다

### 비선점

- 이미 할당된 자원을 강제로 뺏을 수 없다

### 순환 대기

- 대기 프로세스의 집합이 순환 형태로 자원을 대기하고 있어야 한다
- 공유자원을 사용하기 위해선느 대기하는 프로세스들이 원형으로 구성되어있어 자신에게 할당된 자원을 점유하면서 앞이나 뒤에 있는 프로세스의 자원을 요구해야 한다

## 데드락 예방(Prevention)

- 교착상태의 발생조건 4가지 중 하나라도 발생하지 않게 하는 것
- 각각의 조건을 방지하여 교착상태발생 가능성을 차단
- 자원 낭비가 심하다
- 시스템의 처리량이나 효율성을 떨어트리는 단점

### 상호 배제 방지

- 한번에 여러 프로세스가 공유 자원을 사용할 수 있게 한다
- 추후 동기화 관련 문제가 발생 가능

### 점유 대기 방지

- 프로세스 실행에 필요한 모든 자원을 한꺼번에 요구하고 허용할 때까지 작업을 보류
- 나중에 또 다른 자원을 점유하기 위한 대기 조건을 성립하지 않도록 한다

### 비선점 방지

- 이미 다른 프로세스에게 할당된 자원이 선점권이 없다고 가정할 때, 높은 우선 순위의 프로세스가 해당 자원을 선점할 수 있도록 한다
- 자원을 점유하고 있는 프로세스가 다른 자원을 요구 할 떄 점유하고 있는 자원을 반납하고, 요구한 자원을사용하기 위해 기다리게 한다

### 순환 대기 방지

- 자원을 선형 순서로 분류하여 고유 번호를 할당하고, 자원을 순환 형대로 대기하지 않도록 어느 한 쪽 방향으로만 자원 요구

## 데드락 회피(Avoidence)

- **안정 상태(safe state)”** 시스템의 프로세스들이 요청하는 모든 자원을 데드락을 발생시키지 않으면서도 차례로 모두에게 할당해 줄 수 있는 상태
- **안전 순서(safe sequence):** 특정한 순서로 프로세스들에게 자원을 할당, 실행 및 종료 등의 작업을  할 때 데드락이 발생하지 않는 순서를 찾을 수 있는 상태
- **불안정 상태:** 데드락 발생 가능성이 있는 상태이며 교착 상태는 이 때 발생할 수 있다
- 회피 알고리즘은 자원을 할당한 후에도 시스템이 항상 안정 상태에 있을 수 있도록 할당을 허용하자는 것이 기본 특징

## 데드락 탐지(Detection)

- 시스템에 교착 상태가 발생했는지 점검하여 교착상태에 있는 프로세스와 자원을 발견하는 것을 의미

## 데드락 회복(Recovery)

- 교착 상태를 일으킨 프로세스를 종료하거나 교착 상태의 프로세스에 할당된 자원을 선점하여 프로세스나 자원을 회복하는 것

### 사용자 처리

- 교착상태에 있는 프로세스 중 하나의 프로세스를 사용자가 강제로 종료

### 시스템 처리

1. 프로세스 중지
    - 교착 상태에 속해있는 모든 프로세스를 중지
    - 교착 상태가 해결될 때 까지 한 프로세스씩 중지
2. 자원 선점
    - 프로세스들로부터 자원을 빼앗아 교착 상태가 해결될 때까지 프로세스들에게 자원을 할당

# 예상 질문

### 1. 교착상태란?

- 상호 배제에 의해 나타나는 문제점으로, 둘 이상의 프로세스들이 자원을 점유한 상태에서 서로 다른 프로세스가 점유하고 있는 자원을 요구하며 무한정 기다리는 현상
- 발생조건 4가지…

### 2. 교착 상태의 해결 방법

- 예방, 회피, 탐지, 회복

**참고**

[[OS] 교착상태란 무엇인가?](https://coding-factory.tistory.com/311)

[[운영체제] 데드락(Deadlock, 교착 상태)이란?](https://chanhuiseok.github.io/posts/cs-2/)
