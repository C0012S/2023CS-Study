# 시스템 콜

> 운영 체제의 커널이 제공하는 서비스에 대해, 응용 프로그램의 요청에 따라 커널에 접근하기 위한 인터페이스
> 
- 사용자 프로그램이 디스크 파일을 접근하거나 화면에 결과를 출력하는 등의 작업이 필요한 경우, 즉 사용자 프로그램이 특권 명령의 수행을 필요로 하는 경우, 운영체제에게 특권 명령의 대행을 요청
- 보통 직접적으로 시스템 콜을 사용하기 보다는 API(라이브러리 함수)를 통해 사용
    - 이식성 때문
    - 사용하는 곳마다 시스템 콜을 하는 환경이 다를텐데 API는 인자만 반환해주면 간단
- 대부분의 운영체제는 커널 모드와 사용자 모드가 구분되어 있는데, 이러한 상황에서 시스템 콜은 사용자 모드에서 커널 모드로 들어가는 것

### 유저 모드

- PC 레지스터가 사용자 프로그램이 올라가 있는 메모리 위치를 가리키고 있을 때 현재 사용자가 프로그램을 수행중이라고 하며 CPU가 유저모드에서 수행중이라고 말한다
- 사용자가 접근할 수 있는 영역에 제한이 있기 때문에 하드웨어에 접근 불가능
- 하드웨어 접근하기 위해서 시스템 콜 사용해야 함

### 커널 모드

- 운영체제(OS)가 CPU를 사용하는 모드
- PC register 가 운영체제가 존재하는 부분을 가리키고 있다면 현재 운영체제의 코드를 수행중이라고 하며 CPU가 커널모드에서 수행중이라고 말한다.
- 시스템 콜을 통해 커널모드로 전환이 되면 운영체제는 하드웨어를 제어하는 명령어(Privileged Instructions)를 실행
    - Privileged Instructions는 사용자 모드에서 실행되면 exception이 발생

## 종류

### 1. 프로세스 제어(Process Contro)

- 프로세스 생성 및 종료
- 메모리에 로드, 실행
- 프로세스 속성 값 확인, 지정
- wait 이벤트, signal 이벤트
- 메모리 할당

### 2. 파일 조작(File Manipulation)

- 파일 생성, 파일 삭제
- 열기, 닫기
- 읽기, 쓰기 , Reposition
- 파일 속성 값 확인, 지정

### 3. 장치 관리(Device Manipulation)

- 디바이스 요청 및 해제
- 읽기 , 쓰기, Reposition
- 디바이스 속성 확인, 지정
- 비물리적인 디바이스 해제 및 장착

### 4. 정보 유지(Information Maintenance)

- 시간 확인, 시간 지정
- 시스템 데이터 확인, 지정
- 프로세스, 파일, 디바이스 속성 가져오기
- 프로세스, 파일, 디바이스 속성 설정하기

### 5. 통신(Communication)

- 커뮤니케이션 연결 생성 및 삭제
- 메시지 송신, 수신
- 상태 정보 전달
- remote 디바이스 해제 및 장착

### 6. 보호(Protection)

- Permission 획득
- Permission 설정

## 구현

그림: open() API 호출시의 동작 흐름

![Untitled](https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2Fv13g9%2FbtryuWqR3ap%2FBlHhB9sWyD5TuvhST3Es50%2Fimg.png)

- 각각의 시스템 콜은 table이라는 곳에서 index를 할당 받음
- 시스템 콜 인터페이스는 시스템 콜 번호와 시스템 콜 핸들러 함수 주소로 구성되는 시스템 콜 테이블 유지
- 시스템 콜 인터페이스는 할당된 번호에 맞는 index를 찾아서 실행 후 반환

## 필요한 이유

- 우리가 일반적으로 사용하는 프로그램은 ‘응용 프로그램’
- 유저레벨의 프로그램은 유저레벨의 함수들 만으로는 많은 기능을 구현하기 힘들다
    - **커널**의 도움을 반드시 받아야 함
- 이러한 작업은 유저 모드에서는 수행 불가능
- 반드시 커널과 관련된 것은 커널 모드로 전환 후에 해당 작업 수행 가능
- 유저 애플리케이션이 운영체제의 치명적인 데이터를 수정/삭제하는 권한을 막는다

# 질문

### 시스템 콜이란

- 운영 체제의 커널이 제공하는 서비스에 대해, 응용 프로그램의 요청에 따라 커널에 접근하기 위한 인터페이스

### 시스템 콜을 사용하는 이유

- 유저레벨의 프로그램은 유저레벨의 함수들 만으로는 많은 기능을 구현하기 힘들어 커널의 도움을 받아야 하기 때문
- 유저 애플리케이션이 운영체제의 치명적인 데이터를 수정/삭제하는 권한을 막는다

**참고**

[[Operating System] (iOS) System Call (시스템콜, 시스템 호출이란?)](https://didu-story.tistory.com/311)

[운영체제 System call ( 시스템 콜 )](https://wpaud16.tistory.com/245)

[[OS] 시스템 콜, System Call](https://velog.io/@nnnyeong/OS-시스템-콜-System-Call)
