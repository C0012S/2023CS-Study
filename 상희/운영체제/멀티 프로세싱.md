# 💡 멀티 프로세싱

# ✅ 멀티 프로세싱이란?
- 멀티 프로세싱은 다수의 프로세서가 서로 협력적으로 일을 처리하는 것을 의미한다.
- 컴퓨터는 1대인데 **프로세서**(CPU)는 2개 이상이다. 보통, 멀티 코어 시스템(multi-core system)을 포함한다.

> 주의해야 할 점  
: 프로세스가 아니라 프로세서이다.
> 

<br/>

### 프로세서
CPU나 Microprocessor라는 하드웨어를 의미한다.

<br/>

### 프로세스
실제 메모리에 적재되어 프로세서에 의해 실행되고 있는 프로그램을 의미한다.

<br/>

![https://velog.velcdn.com/images%2Fchy0428%2Fpost%2F64d411b0-0f60-48e0-897e-f535e98ee9d0%2Fimage.png](https://velog.velcdn.com/images%2Fchy0428%2Fpost%2F64d411b0-0f60-48e0-897e-f535e98ee9d0%2Fimage.png)

<br/>

보통 하나의 프로세서(CPU)가 하나의 작업을 맡지만, 멀티 프로세싱은 다수의 프로세서가 다수의 작업을 함께 처리하는 것을 의미한다.

![https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FNsBOQ%2Fbtq84u6rySg%2FsupHkC9UXJVYuD0XZ0mfJ1%2Fimg.jpg](https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FNsBOQ%2Fbtq84u6rySg%2FsupHkC9UXJVYuD0XZ0mfJ1%2Fimg.jpg)

<br/>

많은 양의 작업을 빠른 시간에 처리하기 위해서는 단일 프로세서가 처리하는 것보다 멀티 프로세서로 처리하는 것이 빠를 것이다.  
즉, 여러 개의 프로세서가 작업을 병렬 처리 하는 것으로 정의하는 것이 정확한 개념일 것이다.

<br/>

## 멀티 프로세싱 장단점
### 멀티 프로세싱 장점
- 신뢰성 증가
    - 하나의 프로세서가 고장이 나더라도 해당 프로세서가 진행 중인 작업은 다른 프로세서에서 수행하고 있기 때문에 작업이 정지되지 않는다.
    - 기능들이 여러 개의 프로세서에 적절히 분산된다면 한 프로세서가 고장나더라도 시스템이 정지하는 것이 아니라 단지 속도만 느려지게 된다.
- 비용 절약
    - 여러 개의 프로세스가 처리되어야 할 때, 동일한 데이터를 사용한다면 각 데이터를 각 프로세서에게 할당할 필요 없이 하나의 공간에 데이터를 저장한 후 이를 공유하여 사용하도록 한다면 비용을 절약할 수 있다.
    - 멀티 프로세싱을 이용할 경우 여러 개의 단일 프로세싱보다 비용이 절약될 수 있다. 이는 프로세서가 주변 장치, 대용량 저장 장치, 전원 공급 장치를 서로 공유하고 있기 때문이다.

<br/>

### 멀티 프로세싱 단점
- 프로세스는 메모리 공간 측면에서 독립적 이기 때문에 원칙적으로 서로의 데이터를 공유 할 수 없다. A 프로세스의 연산 결과를 B 프로세스에서 꼭 필요하다면, IPC(ex : PIPE)를 이용한다. IPC는 구현도 어렵고 아주 복잡하다.
- 프로세스는 스케줄링 대상이므로 멀티 프로세싱 시, 상당히 많은 문맥 교환(컨텍스트 스위칭)이 일어난다. 이는 오버헤드로 이어진다.
    - A 프로세스 → B 프로세스 문맥 교환 시 A프로세스 메모리 내려 놨다가 다시 B프로세스 메모리 불러 왔다가 해야 한다.

<br/>

## 멀티 프로세싱 종류
### 대칭형 멀티 프로세싱(SMP, Symmetric Multi-Processing)
- 운영체제와 메모리를 공유하는 여러 프로세서가 프로그램을 수행하는 것을 말한다.
- SMP에서는 프로세서가 메모리와 입출력 버스 및 데이터 경로(path)를 공유하며, 하나의 운영체제가 모든 프로세서를 관리한다. 자원들을 서로 공유하면서 동기화가 필요하다는 말이다.
- 주종 관계가 없이, 모든 프로세서들이 동일한 peer로 동작한다. 각 프로세서는 다른 프로세서의 간섭 없이 각자 자신의 작업을 수행한다. N개의 cpu가 있으면 성능을 크게 저하하지 않으면서 N개의 프로세스를 실행한다.
- 프로세스 및 메모리 같은 자원을 다양한 프로세서 간에 동적으로 공유할 수 있으며 프로세서 간의 작업 부하 분산을 낮출 수 있다.
- 각 프로세서는 스스로 스케줄링을 한다. 공통의 ready queue를 갖거나, 각자 private ready queue를 가질 수 있다.
- SMP 시스템에서 여러 프로세서를 최대한 활용하기 위해 부하를 모든 처리기에 균등하게 배분하는 것이 중요하다.

<br/>

### 비대칭형 멀티 프로세싱(AMP, Asymmetric Multi-Processing)
- AMP는 각 프로세서가 특정된 일을 맡아서 한다.
- 주 프로세서가 전체 시스템을 통제하고 다른 프로세서들은 주인의 명령을 따르거나 또는 미리 정해진 일을 수행한다.
- 이 방식은 주/종속(Master/Slave) 시스템의 형태로서 주 프로세서가 종속 프로세서들을 스케줄하고 일을 할당한다.
- 장점 : 자료 공유의 필요성을 감소시키므로 단순하다.
- 단점 : 마스터 프로세서가 전체 시스템 성능을 저하시킬 수 있는 병목 현상이 생긴다. 즉, 다른 Slave 프로세서들은 Master 프로세서가 작업을 할당할 때까지 기다려야 한다.

<br/>

![https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FbWvojb%2FbtqDGI1rcRB%2FvQEAkRr0lax7Sz8cVr8EZ0%2Fimg.png](https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FbWvojb%2FbtqDGI1rcRB%2FvQEAkRr0lax7Sz8cVr8EZ0%2Fimg.png)

<br/>
<br/>

# ✅ 멀티 프로그래밍
초기의 컴퓨터에서는 하나의 프로그램이 메모리에 올라가면 하나의 프로그램만 CPU가 처리를 진행할 수 있었다. 이 과정에서 프로세서의 처리 속도와 입출력 속도 간의 차이로 인해, 입출력이 완료될 때까지 프로세서는 IDLE한 상태가 된다. 따라서 이는 프로세서의 `자원 낭비`로 이루어진다.  
프로세서가 **입출력 작업의 종료를 대기할 동안 하나의 프로세서에서 다른 프로그램을 수행할 수 있도록 하는 것**이 멀티 프로그래밍이다.

<br/>

※ IDLE 상태(유휴 상태) : 프로세스가 실행하고 있지 않은 상태

<br/>
<br/>

# ✅ 멀티 태스킹
- `Task`는 운영체제에서 처리하는 작업의 단위 또는 정해진 일을 수행하기 위한 명령어 집합을 뜻한다.(`Process`보다 확장된 개념)  
- 멀티 태스킹은 **하나의 프로세서상에서 Task를 OS의 스케줄링에 의해 Task를 번갈아 가며 수행하는 것**을 의미한다.  
- 여러 개의 Task를 자주 번갈아 가며 수행하다 보니 사용자는 동시에 여러 Task가 수행되고 있다고 느끼게 된다.

<br/>

> 컴퓨터로 워드를 작성하면서 그림판으로 그림을 그릴 수 있는 것도 멀티 태스킹이다.
> 

<br/>

## 멀티 프로그래밍 vs 멀티 태스킹
멀티 프로그래밍은 프로세서의 자원 낭비를 막기 위함이고, 멀티 태스킹은 정해진 시간 동안 각각의 Task를 번갈아 가며 수행하는 것을 의미한다.

<br/>

## 멀티 태스킹의 종류
### 선점형 멀티 태스킹
- 프로세스가 CPU를 차지해 사용해도 운영체제가 타이머나 트리거로 개입해 강제로 CPU를 빼앗아 올 수 있다.
- 운영체제가 응답 없는 프로세스를 강제로 죽일 수 있다.
- 시간을 정해 놓고 시간마다 선점이 일어나는데, 이 시간 단위를 퀀텀 혹은 슬라이스라고 한다.
- 퀀텀이 너무 낮으면 프로세스를 바꾸는 데 소모되는 리소스가 커지고, 퀀텀이 너무 높으면 반응 속도가 느려진다.

<br/>

### 비선점형 멀티 태스킹
- CPU를 빼앗는 것이 아니다.
- 운영체제가 응답 없는 프로세스를 강제로 죽일 수 없고 리셋해야 한다.
- 프로그램은 실행되면 프로세스가 되고, 프로세스는 여러 스레드를 실행시키는데, 여러 프로그램에서 만들어지는 스레드는 CPU라는 한정된 자원을 서로 사용하고자 경쟁한다.
- 따라서 운영체제는 CPU의 시간을 나누어 여러 스레드에게 돌아가면서 실행하도록 하고, 이 때 CPU를 차지하고 있는 스레드가 CPU 연산이 필요 없음을 나타냈을 때에만 운영체제가 이를 회수할 수 있다.

<br/>

## 멀티 태스킹의 스케줄링 방식
- 멀티 프로그래밍 방식(Multi-Programming)
- 시분할 방식(Time-Sharing)
- 실시간 시스템 방식(Real-Time)

<br/>
<br/>

# 🗣 면접 예상 질문
### Q1. 멀티 프로세싱 무엇인가요?
- 멀티 프로세싱은 다수의 프로세서가 서로 협력적으로 일을 처리하는 것을 의미한다.

<br/>

### Q2. 동시성과 병렬성의 차이를 설명해 주세요.
- 동시성(Concurrency)은 하나의 코어가 여러 프로세스를 번갈아 가며 실행해서 실제로는 하나씩 실행되지만 동시에 실행되는 것처럼 보이는 것을 의미한다. 이를 시분할 시스템이라고도 한다.
- 병렬성(Parallelism)은 여러 개의 코어가 각각 프로세스를 담당하며 실제로 여러 프로세스가 동시에 실행되는 것을 의미한다.

<br/>

### Q3. 멀티 프로세싱의 장점은 무엇인가요?
- 멀티 프로세싱을 이용할 경우 여러 개의 단일 프로세싱보다 비용이 절약될 수 있다.
- 한 프로세서가 고장나더라도 시스템이 정지하지 않아 신뢰성이 있다는 장점이 있으나 속도가 느려진다는 문제점이 있다.

<br/>
<br/>

# 🗂 참고
- [[OS] 멀티프로세싱, 멀티프로그래밍, 멀티태스킹, 멀티스레딩 (velog.io)](https://velog.io/@chy0428/OS-%EB%A9%80%ED%8B%B0%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%98%EB%B0%8D-%EB%A9%80%ED%8B%B0%ED%94%84%EB%A1%9C%EC%84%B8%EC%8B%B1)
- [멀티 프로세싱 vs 멀티 프로그래밍 vs 멀티 태스킹 vs 멀티 스레딩 (tistory.com)](https://sorjfkrh5078.tistory.com/56)
- [멀티 프로세싱이란? (tistory.com)](https://donghoson.tistory.com/15)
- [대칭형 다중 처리 (SMP) (tistory.com)](https://vaert.tistory.com/38)
- [멀티 프로세싱과 멀티 태스킹 (velog.io)](https://velog.io/@woga1999/%EB%A9%80%ED%8B%B0-%ED%94%84%EB%A1%9C%EC%84%B8%EC%8B%B1%EC%9D%B4%EB%9E%80)
- [대칭과 비대칭 멀티 프로세싱 :: Cog Factory (tistory.com)](https://clownhacker.tistory.com/10)
- [멀티태스킹이란? (tistory.com)](https://donghoson.tistory.com/16)
- [[OS] 운영체제 질문 - (프로세스,스레드,동기화 문제,교착상태,페이징,가상메모리) (tistory.com)](https://onejunu.tistory.com/159)
- [멀티프로세싱과 멀티쓰레딩 (tistory.com)](https://jeunjeun.tistory.com/6)
- [프로세스 & 스레드 (Process & Thread) — yg323 (tistory.com)](https://gyeong-log.tistory.com/30)
